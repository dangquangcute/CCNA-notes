# Phần 7: phân tích quá trình trao đổi  dữ liệu giữa các phân vùng mạng LAN
-   Quá trình trao đổi dữ liệu liên quan trực tiếp đến 2 đơn vị tới 2 đơn vị dữ liệu tại lớp 2 và lớp 3 của mô hình OSI là : cấu trúc Frame và Packet ![Alt text](<Screenshot 2023-09-24 at 12.24.11.png>) Cấu trúc packet có thể lưu hành trên toàn vùng thì cấu trúc frame chỉ có giá trị trên từng phân vùng mạng 
-   Khảo sát ví dụ bên dưới : 
![Alt text](<Screenshot 2023-09-24 at 12.29.00.png>)PC A soạn ra gói tin với src và dst IP, sau khi truyền ra môi trường mạng LAN 1 thì nó sẽ bổ sung thông tin src và dst MAC, thông tin địa chỉ MAC nguồn là MAC A và MAC đích là địa chỉ của default gateway (hay là MAC của cổng f0/1 của Router).
-   Do thiết bị Switch chỉ biết đến các thiết bị thuôc phân vùng của nó. Do đó gói tin sẽ gửi đến thiết bị router, đầu tiên nó sẽ đọc vào layer2 Header cụ thể là địa chỉ MAC đích.![Alt text](<Screenshot 2023-09-24 at 20.55.11.png>)Lúc này nó sẽ thấy địa chỉ MAC là của chính sau đó nó đọc đến IP Header, sau đó check bảng routing table và tiến hành gỡ bỏ địa chỉ MAC cũ đi, gắn thông tin MAC nguồn và đích mới rồi truyền vào port f0/2. Vậy làm sao để nó biết được địa chỉ MAC nhận của địa chỉ IP 20.0.0.2 trên, lúc này R sử dụng giao thức ARP để phân giải IP thành MAC. Sau khi router soạn được gói tin với MAC tương ứng => Switch, Switch dựa vào bảng MAC address table và chuyển đến thiết bị tương ứng. Và đương nhiên Switch cũng chỉ biết được MAC của các thiết bị trong phân vùng
-   Ta thấy cấu trúc layer2 Header trong tình huống trên sẽ được thay đổi tùy theo vùng mạng mà nó đi qua. 
-   Bên cạnh công nghệ Ethernet thì lớp Datalink còn có 1 số công nghệ layer2 khác như : 
+ PPP(point to poitn protocol) cho phép chúng ta truyền với khoảng cách xa hơn 
-   Khảo sát quá trình truyền dữ liệu từ PC 1 => PC 3 : ![Alt text](<Screenshot 2023-09-24 at 21.07.05.png>)Khi mà công nghệ layer 2 của 3 phân vùng này liên tục thay đổi. PC 1 soạn ra gói tin với layer 2 Header là Ethernet Header thì mới có thể di chuyển được trên Ethernet LAN ![Alt text](<Screenshot 2023-09-24 at 21.09.27.png>) Khi gói tin đến được Router 1 nó sẽ định tuyến để đến được R2 và nó phát hiện được là môi trường kn giữa R1 và R2 không phải là Ethernet mà là ppp, nó sẽ gắn ppp Header để phù hợp với môi trường truyền dẫn![Alt text](<Screenshot 2023-09-24 at 21.14.48.png>) Khi đến được R2 nó sẽ tiếp tục định tuyền để đến được PC 3, nó sẽ gỡ bỏ ppp Header và thay thể bằng Ethernet Header để phù hợp ![Alt text](<Screenshot 2023-09-24 at 21.16.41.png>)